// Функция проверки авторизации администратора
function checkAdminLogin() {
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;

    // Проверяем введённые данные
    if ((username === 'admin' && password === 'admin123') || 
        (username === 'prodtorg' && password === 'prodtorg2024') || 
        (username === 'manager' && password === 'manager123')) {
        sessionStorage.setItem('loggedInUser', username); // Сохранение текущего залогиненного пользователя
        window.location.href = 'admin.html'; // Переходим в админ-панель
    } else {
        alert('Неверный логин или пароль');
    }
}

// Обработчик нажатия кнопки входа
document.getElementById('loginBtn').addEventListener('click', checkAdminLogin);

// Форма изменения пароля
function changePassword() {
    const currentUsername = prompt("Введите ваше имя пользователя:");
    const newPassword = prompt("Введите новый пароль:");
    
    if (currentUsername === 'admin') { // Только администратор может менять пароль
        localStorage.setItem('admin_password', newPassword); // Хранение нового пароля в Local Storage
        alert('Пароль успешно изменён!');
    } else {
        alert('Только администратор может изменить пароль.');
    }
}

// Формируем уникальный идентификатор гостя
function generateGuestId(name, phoneNumber) {
    return `${name}-${phoneNumber}`;
}

// Авторизация гостей
function registerGuest() {
    const guestName = prompt("Введите ваше имя:");
    const guestPhone = prompt("Введите ваш номер телефона:");

    const guestId = generateGuestId(guestName, guestPhone);
    localStorage.setItem(guestId, JSON.stringify({ name: guestName, phone: guestPhone }));

    alert(`Вы зарегистрированы как ${guestName}. Ваш телефон: ${guestPhone}`);
    window.location.href = 'index.html';
}

// Определение роли пользователя при загрузке страницы
window.onload = function () {
    const loggedInUser = sessionStorage.getItem('loggedInUser');
    if (!loggedInUser) {
        let userChoice = confirm("Хотите войти как гость?");
        
        if (userChoice) {
            registerGuest(); // Зарегистрироваться как гость
        } else {
            alert("Пожалуйста, войдите как администратор.");
        }
    }
};
